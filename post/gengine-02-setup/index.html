<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>G-Engine #2: Project Setup - Clark Kromenaker</title>
<meta name=description content="The previous post introduced the G-Engine project. So here we are, ready to build a 3D game engine! This post walks through some early decisions, starting from absolutely nothing to having just an empty application window that can be moved around and closed.
This is not the most exciting end result, but there are plenty of important decisions to be made before we dig into actually writing game engine code."><meta name=author content="Clark Kromenaker"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"Clark Kromenaker","url":"https:\/\/clarkkromenaker.com\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/clarkkromenaker.com\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/clarkkromenaker.com\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/clarkkromenaker.com\/post\/gengine-02-setup\/","name":"G engine #2 project setup"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"Clark Kromenaker"},"headline":"G-Engine #2: Project Setup","description":"The previous post introduced the G-Engine project. So here we are, ready to build a 3D game engine! This post walks through some early decisions, starting from absolutely nothing to having just an empty application window that can be moved around and closed.\nThis is not the most exciting end result, but there are plenty of important decisions to be made before we dig into actually writing game engine code.\n","inLanguage":"en","wordCount":2489,"datePublished":"2018-10-27T00:00:00","dateModified":"2018-10-27T00:00:00","image":"https:\/\/clarkkromenaker.com\/img\/avatar-icon.png","keywords":["G-Engine, SDL, C\u002b\u002b"],"mainEntityOfPage":"https:\/\/clarkkromenaker.com\/post\/gengine-02-setup\/","publisher":{"@type":"Organization","name":"https:\/\/clarkkromenaker.com\/","logo":{"@type":"ImageObject","url":"https:\/\/clarkkromenaker.com\/img\/avatar-icon.png","height":60,"width":60}}}</script><meta property="og:title" content="G-Engine #2: Project Setup"><meta property="og:description" content="The previous post introduced the G-Engine project. So here we are, ready to build a 3D game engine! This post walks through some early decisions, starting from absolutely nothing to having just an empty application window that can be moved around and closed.
This is not the most exciting end result, but there are plenty of important decisions to be made before we dig into actually writing game engine code."><meta property="og:image" content="https://clarkkromenaker.com/img/avatar-icon.png"><meta property="og:url" content="https://clarkkromenaker.com/post/gengine-02-setup/"><meta property="og:type" content="website"><meta property="og:site_name" content="Clark Kromenaker"><meta name=twitter:title content="G-Engine #2: Project Setup"><meta name=twitter:description content="The previous post introduced the G-Engine project. So here we are, ready to build a 3D game engine! This post walks through some early decisions, starting from absolutely nothing to having just an â€¦"><meta name=twitter:image content="https://clarkkromenaker.com/img/avatar-icon.png"><meta name=twitter:card content="summary_large_image"><link href=https://clarkkromenaker.com/img/favicon.ico rel=icon type=image/x-icon><meta name=generator content="Hugo 0.133.1"><link rel=alternate href=https://clarkkromenaker.com/index.xml type=application/rss+xml title="Clark Kromenaker"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://clarkkromenaker.com/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://clarkkromenaker.com/css/syntax.css><link rel=stylesheet href=https://clarkkromenaker.com/css/codeblock.css><link rel=stylesheet href=https://clarkkromenaker.com//css/portfolio.css><link rel=stylesheet href=https://clarkkromenaker.com//css/misc.css><link rel=stylesheet href=https://clarkkromenaker.com//css/overrides.css><script src=https://clarkkromenaker.com//js/darkModeToggle.js></script></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=https://clarkkromenaker.com/>Clark Kromenaker</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Blog href=/>Blog</a></li><li><a title=Portfolio href=/portfolio>Portfolio</a></li><li><a title=About href=/about>About</a></li><li><a title=Tags href=/tags>Tags</a></li><li class=navlinks-container id=dark-mode-toggle><a href=javascript:toggleColorScheme();><i id=icon-sun class="fas fa-sun"></i>
<i id=icon-moon class="fas fa-moon"></i></a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title="Clark Kromenaker" href=https://clarkkromenaker.com/><img class=avatar-img src=https://clarkkromenaker.com/img/avatar-icon.png alt="Clark Kromenaker"></a></div></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>G-Engine #2: Project Setup</h1><span class=post-meta><i class=fas></i>Posted on October 27, 2018</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p>The previous post introduced the G-Engine project. So here we are, ready to build a 3D game engine! This post walks through some early decisions, starting from absolutely nothing to having just an empty application window that can be moved around and closed.</p><p>This is not the most exciting end result, but there are plenty of important decisions to be made before we dig into actually writing game engine code.</p><h1 id=why-g-engine>Why &ldquo;G-Engine&rdquo;?</h1><p>In
<a href=https://www.gamasutra.com/view/feature/131536/postmortem_sierra_studios_.ph target=_blank>the GK3 postmortem</a>, Scott Bilas referred to the engine used to build the game as &ldquo;the G-Engine.&rdquo; I don&rsquo;t know if this was an official name or what, but presumably it refers to &ldquo;Gabriel Knight Engine.&rdquo; There are hints in GK3 assets that G-Engine was meant to be reusable, but that clearly never came to fruition.</p><p>Anyway, you need to name your repository and folders something, so I figured &ldquo;G-Engine&rdquo; was as good a name as any. You can always change it later, right? (&mldr;right?)</p><h1 id=language>Language</h1><p>G-Engine will be developed in C++. Since I use Unity at my day job, most of my day-to-day coding is in C#. I like C# just fine, but it means that my C++ skills could use some periodic flexing.</p><p>C++ is also the &ldquo;de facto&rdquo; standard for game engines. One big reason for this is performance. Unity, for example, puts a lot of effort into &ldquo;transpiling&rdquo; C# code into C++ code for performance gains. Unreal Engine&rsquo;s code is written directly in C++.</p><h1 id=version-control>Version Control</h1><p>The engine will be contained within a single repository. Perhaps someday it will make sense to create a separate repository to hold editor code or some other module, but for now, a single repository will do.</p><p>I decided to use Git for version control. Git is very popular these days for open-source development. Git has well-defined workflows for viewing source code, making changes, requesting code reviews, and finally merging changes. Git also does a great job of versioning, branching, and merging text-based assets.</p><h2 id=handling-large-binary-files>Handling Large Binary Files</h2><p>One thing that Git <strong>IS NOT</strong> great for is storing large binary files. This is actually the primary reason that we still use SVN for some of our more asset-heavy projects at Hidden Variable. Recently, Git added better support for large binary files with
<a href=https://git-lfs.github.com/ target=_blank>Git-LFS</a>.</p><p>For this project, the majority of our assets will be text-based, since the engine will be mostly code.</p><p>If you recall from the first post in this series, my plan is to utilize the data files that were included with Gabriel Knight 3, interpreting the data within to reconstruct the game in a modern engine. Those data files are not text-based - they are large binary files, which is not a good fit for Git. What to do?</p><p>Fortunately, this problem solves itself: the data packaged with GK3 is not owned by me, and if I uploaded it to the internet, I&rsquo;d probably be breaking a law or two. As a result, I will not be storing that data in Git. If other people download and run the engine, they will need to provide these copyrighted/licensed assets from a copy of GK3 they have obtained themselves (hopefully through legal means).</p><p>But hypothetically, if I did have to store those files, I&rsquo;d probably use Git LFS.</p><h2 id=hosting>Hosting</h2><p>Though Git repositories can run locally and can be self-contained on a single machine, doing so would negate a major benefit of version control: having a backup. Imagine if I kept all my versioning history locally on my laptop, and then it was stolen or the hard drive crashed!</p><p>There are two big players in Git hosting: Github and Bitbucket. <del>I decided to use Bitbucket because I&rsquo;m already familiar with its interface and tools. You can find the repo for the project here:
<a href=https://bitbucket.org/kromenak/gengine target=_blank>https://bitbucket.org/kromenak/gengine</a></del></p><p>UPDATE: I moved the repo to Github! You can now find it here:
<a href=https://github.com/kromenak/gengine target=_blank>https://github.com/kromenak/gengine</a>.</p><h1 id=ide-and-development-platform>IDE and Development Platform</h1><p>For a long time, PC game development and PC game playing were predominantly done on Windows machines. When GK3 was released in 1999, it only supported Windows. Why support more platforms when everyone was using Windows?</p><p>These days, cross-platform game development (and game playing) is more common. As Apple devices became more popular over the past decade, there&rsquo;s been a bigger market for games that run on Macs. Also, mobile devices more and more work as gaming platforms, so you often need a game to run on iOS and Android, and maybe also Windows, macOS, and Linux in some cases.</p><p>Apple also complicates development a bit: if you want to develop a program for macOS, iOS, or tvOS, you <strong>WILL</strong> at some point need to use a computer running macOS to build and sign your applications. As a result, there is more pressure for game development tools to work on non-Windows platforms too!</p><p>For this game engine, my choice is to begin development on macOS using Xcode as my IDE. This choice was based off of a few things:</p><ol><li>I have a Mac laptop, so it would be most convenient. In contrast, my Windows desktop occasionally crashes at the moment - not so convenient.</li><li>The original game was Windows-only, so getting things up and running on Mac is a decent proof-of-concept of the game working cross-platform.</li><li>I prefer Mac&rsquo;s Unix-based shell system to Windows&rsquo; command-line system, if I need to write shell scripts.</li><li>I haven&rsquo;t used Xcode as an IDE too much, and I&rsquo;d like to get more comfortable with it.</li></ol><p>All that being said, the goal throughout development is to use cross-platform techniques wherever possible. When it comes to changes that need to occur between platforms, those changes are ideally rather small (an alternative function or class) and insulated with a <em>platform-independence layer</em>.</p><h1 id=directory-structure>Directory Structure</h1><p>When you initially create a project in either Xcode or Visual Studio, they both do something I don&rsquo;t like: they put your source code either in the same directory or a subfolder of the solution/workspace/project files (e.g. the .xcodeproj or .sln file).</p><p>This default folder structure is not well suited for cross-platform development. If you create a project in Xcode, the source files are stored inside your Xcode project folder. Later, if you want to compile and run the code in Visual Studio on Windows, you have Visual Studio reaching into the Xcode folder. It feels cluttered and disorganized and not particular cross-platform.</p><p>To combat this, I have decided to structure the project in this way:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Root/
</span></span><span class=line><span class=cl>  Assets/
</span></span><span class=line><span class=cl>    SomeTexture.png
</span></span><span class=line><span class=cl>    Shaders/
</span></span><span class=line><span class=cl>      Skybox.frag
</span></span><span class=line><span class=cl>      Skybox.vert
</span></span><span class=line><span class=cl>  Libraries/
</span></span><span class=line><span class=cl>    minilzo/
</span></span><span class=line><span class=cl>    zlib/
</span></span><span class=line><span class=cl>  Source/
</span></span><span class=line><span class=cl>    Main.cpp
</span></span><span class=line><span class=cl>  Tests/
</span></span><span class=line><span class=cl>    VectorTests.cpp
</span></span><span class=line><span class=cl>  Xcode/
</span></span><span class=line><span class=cl>    GEngine.xcodeproj
</span></span><span class=line><span class=cl>    MacOS/
</span></span><span class=line><span class=cl>      Info.plist
</span></span></code></pre></div><ul><li>Anything that is not code, but is used by the application at runtime, can be stored in <code>Assets</code>. This includes textures, audio, shaders, meshes, binary files, etc. GK3 uses archive files called &ldquo;Barns&rdquo; (BRN extension), which would also be put here.</li><li><code>Libraries</code> contains any code that the engine uses, but which is provided by a third-party. This can include loose source files, static libraries, and dynamic libraries.</li><li>Source code is isolated from any particular IDE, allowing it to be easily used from any IDE, or even compiled using the command line or makefiles.</li><li>Tests can be written and stored separately from application source code to avoid clutter.</li><li>Each IDE has its own folder. When I add Windows support, I&rsquo;d create a <code>VS</code> or <code>VisualStudio</code> folder. There are then subfolders for supported build targets of that IDE. For example, Xcode can build to macOS, iOS, tvOS, etc.</li></ul><p>One question is whether the Source/Tests folders should have subfolders. I think it does make sense to group some related code files together, but it also makes the <code>#include</code> statements more complicated. My plan is to keep most code files at the same level, and perhaps I&rsquo;ll create subfolders as large systems come together. To organize within the IDE, it is actually possible to group files logically without actually changing their locations on the disk, which is maybe more ideal.</p><h1 id=xcode-project-creation>Xcode Project Creation</h1><p>I created a new Xcode project by opening Xcode and selecting <code>File > New > Project</code>. When asked to choose a template, I chose <strong>Command Line Tool</strong> from the <strong>macOS</strong> section.</p><p>The naming of the project templates can be a bit misleading. Both <strong>Cocoa App</strong> and <strong>Game</strong> allow you to create a macOS app that can be released on the App Store - the only difference is the starter code provided. <strong>Command Line Tool</strong> can build more than just command line tools - you can build an entire, complex 3D game with that template. However, an application created with the <strong>Command Line Tool</strong> template can&rsquo;t be easily released on the App Store (unless you significantly adjust the project config later on).</p><p>In hindsight, I made a mistake by selecting <strong>Command Line Tool</strong> here. It made it difficult to use some Apple features (like an App Icon) because my Info.plist file was not set up. Fortunately, this mistake was easily remedied: once the project was created, I could go to <code>File > New > Target</code> and add a new target to the project (using <strong>Game</strong>).</p><p>This highlights one nice thing about Xcode: you can create a Project that contains one or more &ldquo;Targets&rdquo;. Targets potentially share code or other data files, but they are compiled to separate executables, which perhaps support separate platforms. This would allow you, for example, to build to a macOS target and an iOS target with the same codebase and same Xcode project.</p><h1 id=sdl-library-integration>SDL Library Integration</h1><p>One goal I have for this project is for it to be a learning experience. As a result, I don&rsquo;t want to use too many SDKs or libraries that do the hard work for me and obfuscate the things I want to be learning in the first place.</p><p>At the same time, I don&rsquo;t want to re-write things that aren&rsquo;t meant to be rewritten. For example, the
<a href=http://www.oberhumer.com/opensource/lzo/ target=_blank>LZO compression homepage</a> provides compressor and decompressor code - I should definitely use their code, rather than rewrite it myself, if I need LZO compression! (foreshadowing?)</p><p>There are also some systems that I may want to write myself eventually, but it makes sense right now to use some pre-made scaffolding to get things going. You could also call it &ldquo;training wheels&rdquo;. SDL fits into this category.</p><h2 id=what-is-sdl>What is SDL?</h2><p><a href=https://www.libsdl.org/ target=_blank>SDL</a> is a library that I first became familiar with while teaching ITP 380 at USC. Put simply, SDL is a game development library that makes it easier to write a cross-platform game. One example of this is how you tell SDL to initialize a window for the game to run in: it&rsquo;s just one function, but it works as expected on macOS, Windows, Linux, iOS, and Android, among others.</p><p>SDL is a <em>platform-independence layer</em> that provides interfaces for creating a window, receiving OS events, polling inputs, and graphics.</p><p>By using SDL early on, I can let it take care of creating a window, polling OS events, and polling inputs like keyboards and mice. Perhaps someday, I will want to remove SDL and write the code myself. On the other hand, it may prove so useful that I keep it indefinitely.</p><h2 id=integration-process>Integration Process</h2><p>Integrating SDL is fairly easy, <strong>if</strong> you understand how to add plugins to your project! Here&rsquo;s how you do it:</p><p>First,
<a href=https://www.libsdl.org/download-2.0.php target=_blank>download SDL</a> for your platform. Both runtime and development libraries are available. The development library includes header files, which are needed to call SDL functions from your code. The distinction is actually only meaningful for Windows - on Mac, headers are included for both runtime and development libraries. If you are using Linux or some other platform, you may need to build from source or download from your package manager.</p><p>Put the library in your &ldquo;Libraries&rdquo; folder. Depending on your platform, this might be a <code>.dll</code> file (Windows), or a <code>.framework</code> file (Mac) or a <code>.so</code> file (Linux).</p><p>When compiling the project, you need to tell the compiler where the headers and libraries are located, and you also need to tell the linker to link against the library. In Xcode, you do this by adding appropriate entries to <code>Framework Search Paths</code>, <code>Header Search Paths</code>, <code>Library Search Paths</code>, and <code>Other Linker Flags</code>.</p><p>After doing this, it should be possible to use SDL in your project. We&rsquo;ll find out if it worked in the next (and last) step of this post!</p><h1 id=window-creation>Window Creation</h1><p>We now have our Xcode project and we have SDL integrated. We just need to write some code to generate a window using SDL and show it.</p><p>Let&rsquo;s try this in <code>Main.cpp</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;SDL2/SDL.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span> <span class=n>argv</span><span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Init video subsystem. Return 1 on error.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=n>SDL_InitSubSystem</span><span class=p>(</span><span class=n>SDL_INIT_VIDEO</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a 1024x768 window.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SDL_CreateWindow</span><span class=p>(</span><span class=s>&#34;GK3&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1024</span><span class=p>,</span> <span class=mi>768</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Done!
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This works, but it has two big problems. First, the window just closes immediately, since <code>main</code> returns, signaling the end of the program. Second, we are supposed to destroy a window after creating it, using the returned handle.</p><p>OK, so let&rsquo;s change that code a little bit:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;SDL2/SDL.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span> <span class=n>argv</span><span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Init video subsystem. Return 1 on error.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=n>SDL_InitSubSystem</span><span class=p>(</span><span class=n>SDL_INIT_VIDEO</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a 1024x768 window. Return 1 on error.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SDL_Window</span><span class=o>*</span> <span class=n>window</span> <span class=o>=</span> <span class=n>SDL_CreateWindow</span><span class=p>(</span><span class=s>&#34;GK3&#34;</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>1024</span><span class=p>,</span> <span class=mi>768</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>window</span> <span class=o>==</span> <span class=k>nullptr</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Loop forever to stop window from closing right away.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span><span class=p>(</span><span class=nb>true</span><span class=p>)</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Destroy created window.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SDL_DestroyWindow</span><span class=p>(</span><span class=n>window</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Done!
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This also works, kind of. We never see the window because the game gets stuck in that infinite loop! Additionally, there&rsquo;s no way to break out of that infinite loop, so our destroy code will never be called.</p><p>The reason the window doesn&rsquo;t appear, and isn&rsquo;t responsive, is because we aren&rsquo;t polling the OS to respond to events, such as window appear, window move, close button pressed, etc.</p><p>Let&rsquo;s change that:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;SDL2/SDL.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span> <span class=n>argv</span><span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Init video subsystem. Return 1 on error.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=n>SDL_InitSubSystem</span><span class=p>(</span><span class=n>SDL_INIT_VIDEO</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a 1024x768 window.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SDL_Window</span><span class=o>*</span> <span class=n>window</span> <span class=o>=</span> <span class=n>SDL_CreateWindow</span><span class=p>(</span><span class=s>&#34;GK3&#34;</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>1024</span><span class=p>,</span> <span class=mi>768</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>window</span> <span class=o>==</span> <span class=k>nullptr</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Loop forever to stop window from closing right away.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>bool</span> <span class=n>running</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>running</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// We&#39;ll poll for events here. Catch the quit event.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>SDL_Event</span> <span class=n>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=n>SDL_PollEvent</span><span class=p>(</span><span class=o>&amp;</span><span class=n>event</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>switch</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=n>type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=nl>SDL_QUIT</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>running</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Destroy created window.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SDL_DestroyWindow</span><span class=p>(</span><span class=n>window</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Done!
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>That does the trick! We loop until the <code>running</code> bool becomes false. And every frame, we are polling the OS for events. When we get a &ldquo;Quit&rdquo; event from the OS, we set <code>running</code> to false, which breaks out of the loop, destroys the window, and exits the program.</p><p>This is a foundation for the game engine that we&rsquo;ll continue to build upon. One problem is that we&rsquo;ve just got everything in one <code>Main.cpp</code> file. We&rsquo;ll break things up into more manageable chunks in the next post.</p><div class=blog-tags><a href=https://clarkkromenaker.com//tags/g-engine/>G-Engine</a>&nbsp;
<a href=https://clarkkromenaker.com//tags/sdl/>SDL</a>&nbsp;
<a href=https://clarkkromenaker.com//tags/c++/>C++</a>&nbsp;</div></article><ul class="pager blog-pager"><li class=previous><a href=https://clarkkromenaker.com/post/gengine-01-introduction/ data-toggle=tooltip data-placement=top title="G-Engine #1: Introduction">&larr; Previous Post</a></li><li class=next><a href=https://clarkkromenaker.com/post/gengine-03-game-loop/ data-toggle=tooltip data-placement=top title="G-Engine #3: Game Loop">Next Post &rarr;</a></li></ul><div class=disqus-comments><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//clarkkromenaker.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=mailto:kromenak@gmail.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/kromenak title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/clarkkromenaker title=LinkedIn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">Clark Kromenaker
&nbsp;&bull;&nbsp;&copy;
2024</p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Powered by Hugo v0.133.1</a> &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous></script><script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=https://clarkkromenaker.com/js/main.js></script><script>renderMathInElement(document.body)</script></body></html>